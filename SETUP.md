# QuizBox AI 设置指南

## 🔧 环境配置

### 1. 获取 OpenRouter API 密钥

1. 访问 [OpenRouter官网](https://openrouter.ai/)
2. 注册账户并完成邮箱验证
3. 登录后，点击右上角的头像 → "Settings"
4. 在左侧菜单选择 "API Keys"
5. 点击 "Create Key" 创建新的API密钥
6. 复制生成的密钥（格式类似：`sk-or-v1-...`）

### 2. 配置环境变量

在项目根目录创建 `.env.local` 文件：

```bash
# OpenRouter API 配置
OPENROUTER_API_KEY=sk-or-v1-你的密钥

# 可选：应用标识（用于OpenRouter统计）
OPENROUTER_APP_NAME=QuizBox-AI
OPENROUTER_SITE_URL=http://localhost:3000
```

### 3. 启动项目

```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm run dev
```

## 🚀 功能特色

### ✨ 流式生成
- **实时显示**：AI生成过程可视化
- **逐步构建**：题目逐个生成和解析
- **即时反馈**：生成状态实时更新

### 📝 在线编辑
- **题目编辑**：修改题目内容、选项、答案
- **解释完善**：添加详细的解题思路
- **格式调整**：优化题目表述和格式

### 🧮 数学公式支持
- **LaTeX渲染**：使用KaTeX引擎，专业数学公式显示
- **实时预览**：编辑时即时查看公式效果
- **符号工具栏**：常用数学符号一键插入
- **混合内容**：文本和公式完美结合
- **语法提示**：内置LaTeX语法帮助和示例

### 🎯 智能生成
- **年级适配**：根据学生年级调整难度
- **主题聚焦**：围绕指定知识点出题
- **类型多样**：支持选择题、填空题等
- **数学题型**：自动生成包含公式的数学题目
- **质量保证**：AI生成 + 人工编辑双重保障

### 📄 PDF导出
- **学生版**：只有题目，用于考试
- **答案版**：包含答案和解释，用于教学
- **公式渲染**：PDF中完美显示数学公式
- **专业排版**：教育级别的PDF格式

## 💰 成本说明

使用 Google Gemini 2.5 Flash Lite 模型：
- **输入成本**：$0.10/M tokens
- **输出成本**：$0.40/M tokens
- **预估费用**：生成10道题目约 $0.01-0.02

## 🆘 常见问题

### Q: API密钥配置后仍然报错？
A: 确保 `.env.local` 文件在项目根目录，重启开发服务器

### Q: 流式生成卡住了？
A: 检查网络连接，或稍后重试。OpenRouter服务偶尔会有延迟

### Q: 生成的题目质量不满意？
A: 可以：
1. 调整提示词更加具体
2. 使用编辑功能手动优化
3. 重新生成直到满意

### Q: PDF下载失败？
A: 当前版本使用HTML格式，建议使用浏览器打印为PDF功能

## 📐 数学公式使用指南

### LaTeX语法基础
```latex
# 基础运算
$a + b - c$           # 加减法
$a \times b$          # 乘法  
$a \div b$            # 除法
$a \pm b$             # 正负号

# 分数和根式
$\frac{a}{b}$         # 分数
$\sqrt{x}$            # 平方根
$\sqrt[3]{x}$         # 立方根

# 指数和下标
$x^2$                 # 平方
$x^{n+1}$             # 复杂指数
$x_1$                 # 下标
$x_{i+1}$             # 复杂下标

# 三角函数
$\sin x$              # 正弦
$\cos x$              # 余弦
$\tan x$              # 正切

# 求和积分
$\sum_{i=1}^{n} x_i$  # 求和
$\int_{a}^{b} f(x)dx$ # 定积分
$\lim_{x \to 0} f(x)$ # 极限
```

### 示例题目
```markdown
题目：计算 $\frac{3}{4} + \frac{1}{8}$ 的结果
选项：A) $\frac{7}{8}$  B) $\frac{5}{8}$
答案：A) $\frac{7}{8}$
解释：通分后 $\frac{6}{8} + \frac{1}{8} = \frac{7}{8}$
```

## 🔄 更新日志

- ✅ 流式生成功能
- ✅ 在线编辑支持  
- ✅ OpenRouter API集成
- ✅ 数学公式支持（KaTeX）
- ✅ LaTeX编辑器和预览
- ⏳ 真实PDF生成（开发中）
- ⏳ 更多题目类型（开发中） 